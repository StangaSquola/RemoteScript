Option Explicit
On Error Resume Next

Dim shell, fso, folder, files, file, mediaPath, soundList, randomFile, i
Dim startTime, durationMinutes, intervalMin, intervalMax, elapsed

Set shell = CreateObject("WScript.Shell")
Set fso = CreateObject("Scripting.FileSystemObject")

' --- CONFIGURAZIONE ---
durationMinutes = 120    ' Durata totale dello script
intervalMin = 120       ' Attesa minima tra i suoni (2 minuti in secondi)
intervalMax = 300       ' Attesa massima tra i suoni (5 minuti in secondi)
mediaPath = "C:\Windows\Media"

' 1. RACCOLTA SUONI DI SISTEMA
Set soundList = CreateObject("System.Collections.ArrayList")
If fso.FolderExists(mediaPath) Then
    Set folder = fso.GetFolder(mediaPath)
    For Each file In folder.Files
        If LCase(fso.GetExtensionName(file.Name)) = "wav" Then
            soundList.Add file.Path
        End If
    Next
End If

' 2. CICLO TEMPORIZZATO (1 ORA)
startTime = Now
Do
    ' Calcola quanto tempo Ã¨ passato
    elapsed = DateDiff("n", startTime, Now)
    If elapsed >= durationMinutes Then Exit Do ' Esci dopo 60 minuti

    Randomize
    
    ' Sceglie e riproduce un suono a caso
    If soundList.Count > 0 Then
        randomFile = soundList.Item(Int(Rnd * soundList.Count))
        
        ' Forza volume al massimo e toglie il muto
        For i = 1 To 50: shell.SendKeys Chr(&hAF): Next
        
        ' Riproduzione nascosta
        shell.Run "powershell -WindowStyle Hidden -Command ""(New-Object System.Media.SoundPlayer('" & randomFile & "')).PlaySync()""", 0, True
    End If

    ' --- ATTESA CASUALE ---
    Dim waitTime
    waitTime = Int((intervalMax - intervalMin + 1) * Rnd + intervalMin)
    WScript.Sleep (waitTime * 1000) 
Loop

